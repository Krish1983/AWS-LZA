# AWS Landing Zone Accelerator Security Configuration
# Generated by Crossplane Platform

homeRegion: us-east-1

# AWS Config Configuration
awsConfig:
  enable: true
  enableConfigurationRecorder: true
  enableDeliveryChannel: true
  ruleSets:
    - deploymentTargets:
        organizationalUnits:
          - Root
      rules:
        - name: ec2-security-group-attached-to-eni
        - name: ec2-stopped-instance
        - name: s3-bucket-ssl-requests-only
        - name: s3-bucket-public-access-prohibited
        - name: s3-bucket-server-side-encryption-enabled
        - name: cloudtrail-enabled
        - name: guardduty-enabled-centralized
        - name: securityhub-enabled
        - name: access-keys-rotated
          parameters:
            maxAccessKeyAge: 90
        - name: iam-password-policy
        - name: iam-user-mfa-enabled
        - name: root-access-key-check

# GuardDuty Configuration
guardDuty:
  enable: true
  excludeRegions: []
  s3Protection:
    enable: true
  eksProtection:
    enable: true
  malwareProtection:
    enable: true
  exportConfiguration:
    enable: true
    destinationType: S3
    exportFrequency: FIFTEEN_MINUTES

# Security Hub Configuration
securityHub:
  enable: true
  regionAggregation: true
  snsTopicName: AtosSecurityHubFindings
  notificationLevel: MEDIUM
  excludeRegions: []
  standards:
    - name: AWS Foundational Security Standard
      enable: true
      controlsToDisable:
        - IAM.1
        - EC2.10
    - name: CIS AWS Foundations Benchmark
      enable: true
      controlsToDisable:
        - CIS.1.5
        - CIS.1.6

# Macie Configuration
macie:
  enable: true
  excludeRegions: []
  policyFindingsPublishingFrequency: FIFTEEN_MINUTES
  publishSensitiveDataFindings: true

# Detective Configuration
detective:
  enable: true
  excludeRegions: []

# Access Analyzer Configuration
accessAnalyzer:
  enable: true

# KMS Configuration
keyManagementService:
  keys:
    - name: AtosEBSKey
      alias: alias/atos/ebs
      policy: kms-policies/atos-ebs-key-policy.json
      description: "Atos KMS key for EBS encryption"
      enabled: true
      enableKeyRotation: true
      deploymentTargets:
        organizationalUnits:
          - Root
    - name: AtosS3Key
      alias: alias/atos/s3
      policy: kms-policies/atos-s3-key-policy.json
      description: "Atos KMS key for S3 encryption"
      enabled: true
      enableKeyRotation: true
      deploymentTargets:
        organizationalUnits:
          - Root

# SNS Topics for Security Alerts
snsTopics:
  - name: AtosSecurityAlerts
    displayName: "Atos Security Alerts"
    kmsKeyName: AtosSecretsKey
    deploymentTargets:
      organizationalUnits:
        - Root
  - name: AtosSecurityHubFindings
    displayName: "Atos Security Hub Findings"
    kmsKeyName: AtosSecretsKey
    deploymentTargets:
      organizationalUnits:
        - Root
%!(EXTRA string=atos-pcsaws-security-config-h4rxv)